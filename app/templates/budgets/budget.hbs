<div class='flex'>
  {{#paper-toolbar tall=editing accent=editing}}
    {{#paper-toolbar-tools}}
      {{#unless editing}}
        {{#paper-button iconButton=true onClick=(route-action 'goBack')}}
          {{paper-icon 'close'}}
        {{/paper-button}}

        <h2>
          {{budget.name}}
        </h2>
      {{/unless}}

      <span class='flex'></span>

      {{#unless editing}}
        {{#paper-menu as |menu|}}
          {{#menu.trigger}}
            {{#paper-button iconButton=true}}
              {{paper-icon 'more-vert'}}
            {{/paper-button}}
          {{/menu.trigger}}

          {{#menu.content width=2 as |content|}}
            {{#content.menu-item onClick='editBudget'}}
              <span>Edit</span>
            {{/content.menu-item}}

            {{#content.menu-item onClick='openDeleteDialog'}}
              <span>Delete</span>
            {{/content.menu-item}}
          {{/menu.content}}
        {{/paper-menu}}

      {{else}}
        {{#paper-button onClick='finishEditing'}}
          <span>Done</span>
        {{/paper-button}}
      {{/unless}}
    {{/paper-toolbar-tools}}

    {{#if editing}}
      <div class='layout-row layout-align-center-center'>
        {{paper-input
          block=true
          disabled=savingEdit
          value=budget.name
          onChange=(action (mut budget.name))
          required=true
        }}
      </div>
    {{/if}}
  {{/paper-toolbar}}

  <div class='budget-balance layout-column layout-align-center-center {{if (lte budget.balance 0) "number--negative" "number--positive"}}'>
    {{to-dollars budget.balance}}
  </div>

  {{#paper-data-table as |table|}}
    {{#table.body as |body|}}
      {{#each sortedTransactions as |transaction|}}
        {{#body.row as |row|}}
          {{#row.cell}}
            {{moment-format transaction.date 'M/D/YY'}}
          {{/row.cell}}

          {{#row.cell}}
            {{transaction.memo}}
          {{/row.cell}}

          {{#row.cell numeric=true}}
            <span class={{if (lte transaction.amount 0) "number--negative" "number--positive"}}>{{to-dollars transaction.amount}}</span>
          {{/row.cell}}
        {{/body.row}}
      {{/each}}
    {{/table.body}}
  {{/paper-data-table}}

  {{#paper-button class='fab--primary' primary=true onClick=(action 'openTransactionDialog') raised=true fab=true}}
    {{paper-icon 'add'}}
  {{/paper-button}}

  {{#if deleteDialog}}
    {{#paper-dialog onClose=(action 'closeDeleteDialog' 'cancel')}}
      {{#paper-toolbar}}
        {{#paper-toolbar-tools}}
          <h3>Delete Budget</h3>
        {{/paper-toolbar-tools}}
      {{/paper-toolbar}}

      {{#paper-dialog-content}}
        <h2>Are you sure you want to delete your {{budget.name}} budget? This action cannot be undone.</h2>
      {{/paper-dialog-content}}

      {{#paper-dialog-actions class='layout-row layout-align-end-center'}}
        {{#paper-button disabled=deletingBudget onClick=(action 'closeDeleteDialog' 'cancel')}}
          Cancel
        {{/paper-button}}

        {{#paper-button disabled=deletingBudget onClick=(action 'closeDeleteDialog' 'ok')}}
          {{if deletingBudget 'Deleting...' 'Delete'}}
        {{/paper-button}}
      {{/paper-dialog-actions}}
    {{/paper-dialog}}
  {{/if}}

  {{#if transactionDialog}}
    {{#paper-dialog fullscreen=true onClose=(action 'closeTransactionDialog' 'cancel')}}
      {{#paper-toolbar}}
        {{#paper-toolbar-tools}}
          <h3>Spend Money</h3>
        {{/paper-toolbar-tools}}
      {{/paper-toolbar}}

      {{#paper-dialog-content}}
        {{paper-input
          block=true
          class='transaction-input'
          label='Amount'
          disabled=savingTransaction
          value=transactionAmount
          onChange=(action (mut transactionAmount))
          required=true
          type='number'
        }}

        {{paper-input
          block=true
          disabled=savingTransaction
          class='transaction-input'
          label='Memo'
          value=transactionMemo
          onChange=(action (mut transactionMemo))
        }}
      {{/paper-dialog-content}}

      {{#paper-dialog-actions class='layout-row layout-align-end-center'}}
        {{#paper-button disabled=savingTransaction onClick=(action 'closeTransactionDialog' 'cancel')}}
          Cancel
        {{/paper-button}}

        {{#paper-button disabled=(or (lte transactionAmount 0) savingTransaction) onClick=(action 'closeTransactionDialog' 'ok')}}
          {{if savingTransaction 'Spending...' 'Spend'}}
        {{/paper-button}}
      {{/paper-dialog-actions}}
    {{/paper-dialog}}
  {{/if}}
</div>